<section class="bg--white">
  <section id="startpage__start-teaser" class="startpage__photo-bar">
    <div class="container">
      <h1 class="display-4 box__bg bg--white mt-5"><%= t(:heading, scope: 'pages.home.search') %></h1>
      <h4 class="startpage-subtitle box__bg bg--white"><%= t(:tagline_html, scope: 'pages.home.search', root_path: root_path) %></h4><BR>
      <div class="box__bg bg--white">
        <%= form_tag(profiles_path, method: 'get') do %>
          <%= render partial: 'shared/search_form' %>
          <h5><%= link_to(t(:all_categories, scope: 'pages.home'), root_path + "#categories_anchor" )%></h5>
          <h5><%= link_to(t(:all_profiles, scope: 'search'), profiles_path ) %></h5>
        <% end %>
      </div>
    </div>
  </section>
  <div class="copyright">
     Copyright: public domain ( modified )
  </div>

  <div class="container">
    <h1 class="box__bg"><%= t(:speaker_headline, scope: 'pages.home.speakers') %></h4>
    <h4 class="border-vertical d-block box__bg mb-4">
      <%= t(:speaker_text, scope: 'pages.home.speakers') %>
      <%= link_to t(:speaker_index, scope: 'pages.home.speakers'), profiles_path %>
    </h1>
    <div class="row">
      <%= render partial: "profiles/profile", collection: @profiles if @profiles.any? %>
    </div>
  </div>

  <section id="startpage__teaser-bg-01" class="startpage__photo-bar">
    <div class="container">
      <h1 class="display-4 box__bg bg--white mt-5"><%= t(:quote, scope: 'pages.home') %></h1>
      <h4 class="startpage-subtitle box__bg bg--white"><%= t(:quote_text, scope: 'pages.home') %></h4>
    </div>
  </section>
  <!-- Anker fÃ¼r Kategorien -->
  <a id="categories_anchor"></a>
  <div class="copyright">
    Copyright by Ute Mayer
  </div>

  <div class="container">
    <h1 class="box__bg">Filter via tags</h1>
    <div class="row">
      <div class="col-3">
        <h5>Choose a category:</h5>
        <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
          <% @categories.each_with_index do |category, index| %>
            <a class="nav-link <%= "active show" if index == 0%>" id="v-pills-<%= category.short_name %>-tab" data-toggle="pill" href="#v-pills-<%= category.short_name %>" role="tab" aria-controls="v-pills-<%= category.short_name %>" aria-selected="false">
              <i class="fa fa-circle pr-2 small"></i><%= category.name %>
            </a>
          <% end %>
        </div>
      </div>

      <div class="col-9">
        <h5>Choose one or more tags:</h5>
        <div class="tab-content mb-3" id="available-tags-box">
          <% @categories.each_with_index do |category, index| %>
            <div class="tab-pane fade <%= "active show" if index == 0%>" id="v-pills-<%= category.short_name %>" role="tabpanel" aria-labelledby="v-pills-<%= category.short_name %>-tab" >
              <%= render partial: "shared/tag_box", locals: { :tags => instance_variable_get("@tags_#{category.short_name}"), :category => category } %>
            </div>
          <% end %>
        </div>
        <div id="selected-tags-box" class="border my-3">
        </div>
        <div class="form-group">
          <%= form_tag(profiles_path, method: "get") do %>
            <%= text_field_tag :tag_search, params[:tag_search], id: "hidden_tag_input", class: "form-control d-none"   %>
            <%= submit_tag "Search in topics", class: "btn btn-primary", id: "search_in_topic" %>
            <span class="btn btn-primary" id="clear"><i class="fa fa-times pr-1"></i>Clear</span>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  <script>
    $( "#available-tags-box .available-tag" ).click(function() {
      $(this).clone().appendTo( "#selected-tags-box" ).append("<i class='pl-2 fa fa-times-circle'></i>").removeClass("available-tag").addClass("selected-tag");
      $(this).addClass( "disabled no-click" );
    });
    $(document).on('click','.selected-tag',function() {
      $(this).remove();
      var tag_name = $(this).attr('id');
      $("#available-tags-box #" + tag_name).removeClass( "disabled no-click" );
    });
    $( "#search_in_topic" ).click(function() {
      var all_tags = $('#selected-tags-box .selected-tag').map(function(){
        return $(this).text();
      }).get().join();
      $('#hidden_tag_input').val(all_tags);
    });
    $( "#clear" ).click(function() {
      $( "#selected-tags-box .selected-tag" ).remove();
      $(".available-tag").removeClass( "disabled no-click" );
    });
    $(document).ready(function() {
      <% if params[:tag_search] %>
        <% params[:tag_search].split(",").each do |tag_name| %>
          $("#<%= tag_name %>").clone().appendTo($( "#selected-tags-box" )).append($("<i class='pl-2 fa fa-times-circle'></i>")).removeClass("available-tag").addClass("selected-tag");
        <% end %>
      <% end %>
    });
  </script>
  <div class="container border-top">
    <h1 class="box__bg">Filter via categories</h1>
    <div class="row">
      <%= render partial: "shared/categories", object: @categories %>
    </div>
  </div>
  <section id="startpage__teaser-bg-02" class="startpage__photo-bar">
    <div class="container">
      <h1 class="display-4 box__bg bg--white mt-5"><%= t(:speaker_shoutout, scope: 'pages.home').html_safe %></h1>
      <h4 class="box__bg bg--white"><%=link_to t(:speaker_text, scope: 'pages.home').html_safe, new_profile_registration_path %></h4>
    </div>
  </section>
  <div class="copyright">
     Copyright by Tilman Vogler
  </div>

  <div class="container">
    <h1 class="box__bg">Speakerinnen*</h1>
    <div class="row pl-4">
      <div class="col-md">
        <h4 class="border-vertical d-block py-2 mb-4 ">
          <%= link_to t(:about_title, scope: 'pages.home.footer'), about_path %>
        </h4>
        <p>
          <%= t(:about, scope: 'pages.home.footer').html_safe %>
          <%= link_to t(:more, scope: 'pages.home.footer').html_safe, about_path  %>
        </p>
      </div>
      <div class="col-md">
        <h4 class="border-vertical d-block py-2 mb-4">
          <%= link_to t(:press, scope: 'pages.home.footer'), press_path %>
        </h4>
        <p>
          <%= t(:press_short, scope: 'pages.home.footer').html_safe %>
          <%= link_to t(:more, scope: 'pages.home.footer').html_safe, press_path  %>
        </p>
      </div>
      <div class="col-md">
        <h4 class="border-vertical d-block py-2 mb-4 ">
          <%= link_to t(:blog, scope:"pages.home.footer"), 'http://blog.speakerinnen.org/', target: '_blank' %>
        </h4>
        <p>
          <% @blog_posts.each do |blogpost| %>
            <strong><%= blogpost.title %></strong><br>
            <%= strip_tags(blogpost.body).truncate(150, separator: ' ') %>
            <%= link_to t(:more, scope: 'pages.home.footer').html_safe, blogpost.url, target: '_blank' %>
            <br>
            <br>
          <% end %>
        </p>
      </div>
    </div>
  </div>
</section>
